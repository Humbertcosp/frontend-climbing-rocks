<ion-content fullscreen>
  <div class="container">
    <ion-card class="auth-card">
      <ion-card-header>
        <ion-card-title>Entrar</ion-card-title>
        <ion-card-subtitle>Bienvenido de nuevo</ion-card-subtitle>
      </ion-card-header>

      <ion-card-content>
        <form [formGroup]="form" (ngSubmit)="submit()">

          <!-- Email -->
          <ion-item
            fill="outline"
            shape="round"
            class="field"
            [class.invalid]="f.email.invalid && (f.email.dirty || f.email.touched)">
            <ion-icon slot="start" name="mail-outline"></ion-icon>
            <ion-input
              type="email"
              label="Email"
              label-placement="floating"
              formControlName="email"
              autocomplete="email">
            </ion-input>
          </ion-item>
          <ion-note class="error"
            *ngIf="f.email.errors?.['required'] && (f.email.dirty || f.email.touched)">
            El email es obligatorio.
          </ion-note>
          <ion-note class="error"
            *ngIf="f.email.errors?.['email'] && (f.email.dirty || f.email.touched)">
            Email no válido.
          </ion-note>

          <!-- Contraseña -->
          <ion-item
            fill="outline"
            shape="round"
            class="field"
            [class.invalid]="f.password.invalid && (f.password.dirty || f.password.touched)">
            <ion-icon slot="start" name="lock-closed-outline"></ion-icon>
            <ion-input
              [type]="showPass ? 'text' : 'password'"
              label="Contraseña"
              label-placement="floating"
              formControlName="password"
              autocomplete="current-password">
            </ion-input>
            <ion-button slot="end" fill="clear" size="small" (click)="showPass = !showPass">
              <ion-icon [name]="showPass ? 'eye-off-outline' : 'eye-outline'"></ion-icon>
            </ion-button>
          </ion-item>
          <ion-note class="error"
            *ngIf="f.password.errors?.['required'] && (f.password.dirty || f.password.touched)">
            La contraseña es obligatoria.
          </ion-note>

          <!-- Recuérdame + Olvidé contraseña -->
          <div class="row">
            <ion-item lines="none" class="compact">
              <ion-toggle formControlName="remember">Recuérdame</ion-toggle>
            </ion-item>
            <a class="forgot" routerLink="/auth/forgot">¿Olvidaste tu contraseña?</a>
          </div>

          <!-- Error servidor -->
          <ion-note *ngIf="error" color="danger" class="server-error">{{ error }}</ion-note>

          <!-- Botón -->
          <ion-button
            class="submit"
            expand="block"
            size="large"
            shape="round"
            type="submit"
            [disabled]="form.invalid || loading">
            <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>
            <span *ngIf="!loading">Entrar</span>
          </ion-button>

          <div class="alt">
            ¿No tienes cuenta?
            <a routerLink="/auth/register">Crear cuenta</a>
          </div>
        </form>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>