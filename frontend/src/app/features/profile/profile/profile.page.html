<ion-header>
  <ion-toolbar>
    <ion-title>Perfil</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding-top">

  <!-- Con sesión -->
  <ng-container *ngIf="usuario; else sinSesion">
    <div class="profile-header">
      <img class="avatar" [src]="avatarSrc" alt="avatar" />
      <h1>{{ displayName }}</h1>
      <p class="email">{{ displayEmail }}</p>
    </div>

    <!-- Contadores compactos (tipo IG) -->
<div class="follow-stats">
  <div class="stat">
    <div class="num">{{ followersCount }}</div>
    <div class="lbl">Seguidores</div>
  </div>

  <div class="divider"></div>

  <div class="stat">
    <div class="num">{{ followingCount }}</div>
    <div class="lbl">Siguiendo</div>
  </div>
</div>
    <ion-list inset>
      <ion-list-header>
        <ion-label>Cuenta</ion-label>
      </ion-list-header>

      <ion-item button (click)="openAccountSettings()">
        <ion-icon slot="start" name="person-circle-outline"></ion-icon>
        <ion-label>Ajustes de cuenta</ion-label>
        <ion-icon slot="end" name="chevron-forward-outline"></ion-icon>
      </ion-item>

      <ion-list-header>
        <ion-label>Preferencias</ion-label>
      </ion-list-header>

      <ion-item>
        <ion-icon slot="start" name="moon-outline"></ion-icon>
        <ion-label>Tema oscuro</ion-label>
        <ion-toggle slot="end"
                    [checked]="isDarkMode"
                    (ionChange)="toggleTheme($event.detail.checked)">
        </ion-toggle>
      </ion-item>

      <ion-item>
        <ion-icon slot="start" name="notifications-outline"></ion-icon>
        <ion-label>Notificaciones</ion-label>
        <ion-toggle slot="end"
                    [checked]="notificationsEnabled"
                    (ionChange)="toggleNotifications($event.detail.checked)">
        </ion-toggle>
      </ion-item>

      <ion-item button (click)="openLanguageSelector()">
        <ion-icon slot="start" name="language-outline"></ion-icon>
        <ion-label>Idioma</ion-label>
        <ion-note slot="end">{{ currentLanguage }}</ion-note>
        <ion-icon slot="end" name="chevron-forward-outline"></ion-icon>
      </ion-item>

      <ion-list-header>
        <ion-label>Información</ion-label>
      </ion-list-header>

      <ion-item button (click)="openPrivacyPolicy()">
        <ion-icon slot="start" name="document-text-outline"></ion-icon>
        <ion-label>Política de privacidad</ion-label>
        <ion-icon slot="end" name="chevron-forward-outline"></ion-icon>
      </ion-item>

      <ion-item button (click)="openTerms()">
        <ion-icon slot="start" name="hammer-outline"></ion-icon>
        <ion-label>Términos y condiciones</ion-label>
        <ion-icon slot="end" name="chevron-forward-outline"></ion-icon>
      </ion-item>

      <ion-item button (click)="openHelp()">
        <ion-icon slot="start" name="help-circle-outline"></ion-icon>
        <ion-label>Ayuda / FAQs</ion-label>
        <ion-icon slot="end" name="chevron-forward-outline"></ion-icon>
      </ion-item>

      <ion-item button (click)="openAbout()">
        <ion-icon slot="start" name="information-circle-outline"></ion-icon>
        <ion-label>Acerca de</ion-label>
        <ion-note slot="end">v{{ appVersion }}</ion-note>
      </ion-item>
    </ion-list>

    <div class="logout-wrapper">
      <ion-button expand="block" color="danger" (click)="logout()">
        <ion-icon slot="start" name="log-out-outline"></ion-icon>
        Cerrar sesión
      </ion-button>
    </div>
  </ng-container>

  <!-- Sin sesión -->
  <ng-template #sinSesion>
    <div class="guest-wrap">
      <ion-card class="guest-card">
        <ion-card-content>
          <ion-icon name="person-circle-outline" class="guest-icon"></ion-icon>
          <h2>Sin sesión</h2>
          <p>Inicia sesión para ver y editar tu perfil.</p>

          <ion-button expand="block" routerLink="/auth/login">Entrar</ion-button>
          <ion-button expand="block" fill="clear" routerLink="/auth/register">
            Crear cuenta
          </ion-button>
        </ion-card-content>
      </ion-card>
    </div>
  </ng-template>

</ion-content>
