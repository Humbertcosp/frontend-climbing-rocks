<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/profile/account"></ion-back-button>
    </ion-buttons>
    <ion-title>Cambiar contraseña</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>

  <div class="card-container">
    <ion-card>
      <ion-card-content>

        <form [formGroup]="form" (ngSubmit)="submit()">

          <ion-item lines="full">
            <ion-label position="floating">Contraseña actual</ion-label>
            <ion-input
              [type]="showCurrent ? 'text' : 'password'"
              formControlName="current">
            </ion-input>
            <ion-icon
              [name]="showCurrent ? 'eye-off-outline' : 'eye-outline'"
              slot="end"
              (click)="showCurrent = !showCurrent">
            </ion-icon>
          </ion-item>
          <ion-note color="danger" *ngIf="form.get('current')?.touched && form.get('current')?.hasError('required')">
            Debes ingresar tu contraseña actual
          </ion-note>

          <ion-item lines="full">
            <ion-label position="floating">Nueva contraseña</ion-label>
            <ion-input
              [type]="showNew ? 'text' : 'password'"
              formControlName="password">
            </ion-input>
            <ion-icon
              [name]="showNew ? 'eye-off-outline' : 'eye-outline'"
              slot="end"
              (click)="showNew = !showNew">
            </ion-icon>
          </ion-item>
          <ion-note color="danger"
            *ngIf="form.get('password')?.touched && form.get('password')?.hasError('minlength')">
            Debe tener al menos 6 caracteres
          </ion-note>

          <ion-item lines="full">
            <ion-label position="floating">Repetir contraseña</ion-label>
            <ion-input
              [type]="showRepeat ? 'text' : 'password'"
              formControlName="confirm">
            </ion-input>
            <ion-icon
              [name]="showRepeat ? 'eye-off-outline' : 'eye-outline'"
              slot="end"
              (click)="showRepeat = !showRepeat">
            </ion-icon>
          </ion-item>
          <ion-note color="danger"
            *ngIf="form.hasError('notMatching') && form.get('confirm')?.touched">
            Las contraseñas no coinciden
          </ion-note>

          <div *ngIf="errorMsg" class="error">{{ errorMsg }}</div>

          <ion-button
            expand="block"
            type="submit"
            [disabled]="form.invalid">
            Guardar cambios
          </ion-button>

        </form>

      </ion-card-content>
    </ion-card>
  </div>

</ion-content>
